{% extends base_template %}

{% load staticfiles %}

{% block title %}Kolibri : A Free, Open Source Education for All{% endblock title%}

{% block headcss %}
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <meta property="og:image" content="{% static 'img/kickstarter/fb-sharedlink.png' %}" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/flipclock.css' %}">
    <link rel="stylesheet" href="{% static 'css/kickstarter.css' %}?asdfghjkl">
    <link rel="stylesheet" href="{% static 'css/_kickstarter_features.css' %}">
    <link rel="stylesheet" href="{% static 'css/_kickstarter_how.css' %}">
    <link rel="stylesheet" href="{% static 'css/_kickstarter_quote.css' %}">
    <link rel="stylesheet" href="{% static 'css/_kickstarter_mobile.css' %}?asdfghjkl">
    <link rel="stylesheet" href="{% static 'css/animate.css' %}">
    <!-- <link rel="stylesheet" href="{% static 'css/igg_integration.css' %}"> -->

    <!-- Custom Fonts -->

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Montserrat:100,400,700' rel='stylesheet' type='text/css'>
    <style>
        #indiegogo_text {
            display: none;
        }
        #fle-navbar {
        -webkit-transform: translateZ(7px);
           -moz-transform: translateZ(7px);
             -o-transform: translateZ(7px);
                transform: translateZ(7px);
        }
        .sticky-signup {
        -webkit-transform: translateZ(7px);
           -moz-transform: translateZ(7px);
             -o-transform: translateZ(7px);
                transform: translateZ(7px);
        }
        #list_donate {
            display: none;
        }
        #list_indiegogo {
            display: none;
        }
    </style>
{% endblock headcss %}

{% block footeroverride %}
    {% include "main/partials/_footer_normal.html" %}
{% endblock footeroverride %}

{% block bodycontents %}
    <!-- Header -->
    <div id="body">
        <header id="kickstarter-header" class="col-md-12">
            <div class="header-shadow row">
                <!---Kolibri Intro-->
                <div class="intro-text">
                    <div class="container">
                        <div class="row">
                            <!-- <div id="campaign-intro-1">Announcing our next-generation platform</div> -->
                            <div id="intro_container">
                            <div class="col-md-6">
                                <div class="intro-heading">Kolibri<span class="hidden-xs hidden-sm" style="font-weight: 100; top:-8px; position: relative;">|</span> </div>
                            </div>
                            <div class="col-md-6">
                                 <div class="intro-heading2">The offline app for<br>universal education</div>
                            </div>
                            </div>

                            <div class="videoWrapper">
                                <iframe id="k_video" src="https://player.vimeo.com/video/143710663" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
                            </div>
    
                            <center><a class="btn" id="igg_btn" href="https://learningequality.org/r/indiegogo-redirect">Back our Kolibri Campaign on <img id="indiegogo_generosity" alt="Indiegogo" src="{% static 'img/kickstarter/indiegogo_generosity.png' %}"></a></center>
                            <!-- <div class="countdown"></div> -->
                            <br><br>
                        </div>
                    </div>
                    <!-- <a id="down-arrow" href="#fle_intro">
                        <div class="arrow-down">
                            <img id="header-btn" src="{% static 'img/kickstarter/arrow.png' %}">
                        </div>
                    </a> -->

                </div>
            </div>
            <!---Arrow Down-->


        </header>

        <!-- sticky sign up bar -->
        {% include "main/partials/_sticky_bar.html" %}

        <img id="slide_tablet" src="/static/img/kickstarter/tablet-min.png">

        <!-- Below the fold version 2 -->
        <section id="fle_intro" class="row">
            {% include "main/partials/_kickstarter_intro2.html" %}
        </section>

        <!-- FLE how it works -->
        <section id="fle_how" class="row">
            <center class="fle_title">
                <h1>HOW WILL IT WORK?</h1>
            </center>
            {% include "main/partials/_kickstarter_how.html" %}
        </section>

        <!-- Features Section: Tile Design -->
        <section id="fle_features" class="row">
            <br><br><br><br><br><br>
            <a href="#portfolioModal1" data-toggle="modal"><div class="fle_title_bold">
                Curated Educational Content<br>
                <p class="slim-text">
                    Education is not "one-size fits all"
                    <br><br>
                    <span>Learn more</span>
                </p>
            </div></a>
            <br><br><br><br><br><br>
            {% include "main/partials/_kickstarter_features_tiledesign.html" %}
        </section>

        <!-- FLE History Section -->
        <section id="fle_timeline" class="row">
            <center class="fle_title">
                <h1>WHO ARE WE?</h1>
                <h2>We're the team that built <img src="{% static 'img/kickstarter/timeline/ka-lite-logo.png' %}"></h2>
                <h3>which has been bringing online education from Khan Academy to the offline world.</h3>
                <h1 class="wow fadeInDown">
                    <img src="{% static 'img/kickstarter/KA-Lite/KA-year.png' %}">
                    <img id="ka-year" src="{% static 'img/kickstarter/KA-Lite/KA-people.png' %}">
                    <img src="{% static 'img/kickstarter/KA-Lite/KA-160.png' %}">
                </h1>
            </center>

            <div id="desktop-timeline"></div>

        </section>

        <!-- FLE Quote Section -->
        <section id="fle_quote" class="hidden-xs">
            {% include "main/partials/_kickstarter_quote.html" %}
        </section>


        <!-- Contact Section -->
        <section id="contact" class="not-parallax-section">
            {% include "main/partials/_kickstarter_footer.html" %}
        </section>

        <a href="#kickstarter-header" class="back-to-top"><span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span></a>


        <!-- Plugin JavaScript -->

        <!-- Contact Form JavaScript -->
        <script src="{% static 'js/jqBootstrapValidation.js' %}" type="text/javascript"></script>
        <!-- WOW Scrolling JavaScript -->
        <script src="{% static 'js/wow.js' %}"></script>
        <script src="{% static 'js/flipclock.min.js' %}"></script>
        <script>
            new WOW().init();
        </script>

        <!-- Smooth scrolling and back to top button -->
        <script>
            $(document).ready(function() {
                var offset = $("#parallax_or_mobile").height() * 3;
                $(window).scroll(function() {
                    if ($(this).scrollTop() > offset) {
                        $('.back-to-top').fadeIn(300);
                    } else {
                        $('.back-to-top').fadeOut(300);
                    }
                });
            });
            $('.back-to-top').click(function() {
                $('html, body').animate({
                    scrollTop: $($.attr(this, 'href')).offset().top
                }, 1500);
                return false;
            });
            $('#be-part').click(function() {
                $('html, body').animate({
                    scrollTop: $($.attr(this, 'href')).offset().top
                }, 1500);
                return false;
            });
            $('#down-arrow').click(function() {
                $('html, body').animate({
                    scrollTop: $($.attr(this, 'href')).offset().top
                }, 900);
                return false;
            });

            // Determines when sticky signup bar becomes... sticky
            // $(function() {
            //     $('.sticky-signup').attr("data-offset-top", $('#kickstarter-header').outerHeight() - 120);
            // });

            // Adds a countdown timer to release day
            FlipClock.Lang.Custom = { days:'Days', hours:'Hours', minutes:'Minutes', seconds:'Seconds' };
            var opts = {
                clockFace: 'DailyCounter',
                countdown: true,
                language: 'Custom'
            };
            var countdown = 1445014800 - ((new Date().getTime())/1000); // from: 10/16/2015 10:00 am -0700
            countdown = Math.max(1, countdown);
            $('.countdown').FlipClock(countdown, opts);

            // Checks whether device is mobile or desktop and applies appropriate html file and styles
            $(function() {
                var isMobileWebkit = /WebKit/.test(navigator.userAgent) && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                if (isMobileWebkit) {
                    // load mobile template for timeline
                    $("#desktop-timeline").load("{% static 'timeline/_kickstarter_timeline_mobile.html' %}");
                    $("#fle_quote").css({"display": "none !important"});
                } else {
                    // load desktop timeline and set min-width of body
                    $("#desktop-timeline").load("{% static 'timeline/_kickstarter_timeline.html' %}");
                    // set styles of bottom iframe on desktop
                    $('iframe').load( function() {
                        $('#header-mailchimp').contents().find("head")
                          .append($("<style type='text/css'>  .email_input_k{width:400px;}  </style>"));
                    });
                    $(window).resize(function() {
                        if ( $('body').width() < 1170 ) {
                            $("#desktop-timeline").load("{% static 'timeline/_kickstarter_timeline_mobile.html' %}");
                        } else {
                            $("#desktop-timeline").load("{% static 'timeline/_kickstarter_timeline.html' %}");
                        }
                    });
                if ( $('body').width() < 1170 ) {
                    $("#desktop-timeline").load("{% static 'timeline/_kickstarter_timeline_mobile.html' %}");
                    } else {
                        $("#desktop-timeline").load("{% static 'timeline/_kickstarter_timeline.html' %}");
                    }
                };

                // Set height of how-image to be the height of the section with infographics, only on bigger screens
                    if ( $('body').width() > 990 ) {
                        var how_height = $(".how-explanation").height();
                        document.getElementById('how-image').style.height = how_height+'px';
                    }

                //load mobile timeline html template when desktop screen size is less than 1000px
                $(window).resize(function() {
                    // Set height of how-image to be the height of the section with infographics, only on bigger screens
                    if ( $('body').width() > 990 ) {
                        var how_height = $(".how-explanation").height();
                        document.getElementById('how-image').style.height = how_height+'px';
                    }
                });

            });





        </script>

        <!-- // <script src="https://f.vimeocdn.com/js/froogaloop2.min.js"></script> -->

        <!-- Google Analytics tracking -->
        <script>

            // Froogaloop library for controlling Vimeo
            var Froogaloop=function(){function e(a){return new e.fn.init(a)}function g(a,c,b){if(!b.contentWindow.postMessage)return!1;a=JSON.stringify({method:a,value:c});b.contentWindow.postMessage(a,h)}function l(a){var c,b;try{c=JSON.parse(a.data),b=c.event||c.method}catch(e){}"ready"!=b||k||(k=!0);if(!/^https?:\/\/player.vimeo.com/.test(a.origin))return!1;"*"===h&&(h=a.origin);a=c.value;var m=c.data,f=""===f?null:c.player_id;c=f?d[f][b]:d[b];b=[];if(!c)return!1;void 0!==a&&b.push(a);m&&b.push(m);f&&b.push(f);return 0<b.length?c.apply(null,b):c.call()}function n(a,c,b){b?(d[b]||(d[b]={}),d[b][a]=c):d[a]=c}var d={},k=!1,h="*";e.fn=e.prototype={element:null,init:function(a){"string"===typeof a&&(a=document.getElementById(a));this.element=a;return this},api:function(a,c){if(!this.element||!a)return!1;var b=this.element,d=""!==b.id?b.id:null,e=c&&c.constructor&&c.call&&c.apply?null:c,f=c&&c.constructor&&c.call&&c.apply?c:null;f&&n(a,f,d);g(a,e,b);return this},addEvent:function(a,c){if(!this.element)return!1;var b=this.element,d=""!==b.id?b.id:null;n(a,c,d);"ready"!=a?g("addEventListener",a,b):"ready"==a&&k&&c.call(null,d);return this},removeEvent:function(a){if(!this.element)return!1;var c=this.element,b=""!==c.id?c.id:null;a:{if(b&&d[b]){if(!d[b][a]){b=!1;break a}d[b][a]=null}else{if(!d[a]){b=!1;break a}d[a]=null}b=!0}"ready"!=a&&b&&g("removeEventListener",a,c)}};e.fn.init.prototype=e.fn;window.addEventListener?window.addEventListener("message",l,!1):window.attachEvent("onmessage",l);return window.Froogaloop=window.$f=e}();

            $(function() {
                $('a[href$="#portfolioModal0"]').click(function(){ga('send', 'event', 'crowdfunding', 'click_modal', 'runs-on-anything');});
                $('a[href$="#portfolioModal1"]').click(function(){ga('send', 'event', 'crowdfunding', 'click_modal', 'content-curation');});
                $('a[href$="#portfolioModal2"]').click(function(){ga('send', 'event', 'crowdfunding', 'click_modal', 'share-and-sync');});
                $('a[href$="#portfolioModal3"]').click(function(){ga('send', 'event', 'crowdfunding', 'click_modal', 'byte-size-videos');});
                $('a[href$="#portfolioModal4"]').click(function(){ga('send', 'event', 'crowdfunding', 'click_modal', 'learn-at-own-pace');});

                $('#quote_video_btn').click(function(){ga('send', 'event', 'crowdfunding', 'play', 'quote-video');});

                $('.fb_btn_1').click(function(){ga('send', 'event', 'crowdfunding', 'share', 'facebook-1');});
                $('.tw_btn_1').click(function(){ga('send', 'event', 'crowdfunding', 'share', 'twitter-1');});
                $('.reddit_btn_1').click(function(){ga('send', 'event', 'crowdfunding', 'share', 'reddit-1');});
                $('.fb_btn_2').click(function(){ga('send', 'event', 'crowdfunding', 'share', 'facebook-2');});
                $('.tw_btn_2').click(function(){ga('send', 'event', 'crowdfunding', 'share', 'twitter-2');});
                $('.reddit_btn_2').click(function(){ga('send', 'event', 'crowdfunding', 'share', 'reddit-2');});

                $('#igg_btn').click(function(){ga('send', 'event', 'crowdfunding', 'click_donate', 'top');});
                $('#join_campaign').click(function(){ga('send', 'event', 'crowdfunding', 'click_donate', 'bottom');});
                $('#readmore_campaign').click(function(){ga('send', 'event', 'crowdfunding', 'click_readmore', 'bottom');});

                $('.sticky-mailchimp').contents().find("#mc-embedded-subscribe").click(function(){ga('send', 'event', 'crowdfunding', 'signup_sticky', $('.sticky-mailchimp').contents().find(".email_input_k").val(), 1);});
                $('.sticky-mailchimp2').contents().find("#mc-embedded-subscribe").click(function(){ga('send', 'event', 'crowdfunding', 'signup_sticky', $('.sticky-mailchimp2').contents().find(".email_input_k").val(), 1);});
                $('#header-mailchimp').contents().find("#mc-embedded-subscribe").click(function(){ga('send', 'event', 'crowdfunding', 'signup_bottom', $('#header-mailchimp').contents().find(".email_input_k").val(), 1);});

                var player = $f($("#k_video")[0]);
                // When the player is ready, add listeners for pause, finish, and playProgress
                player.addEvent('ready', function() {
                    player.addEvent('pause', _.once(onPause));
                    player.addEvent('finish', _.once(onFinish));
                    player.addEvent('playProgress', _.once(onPlay));
                });

                function onPause(id) {
                    ga('send', 'event', 'crowdfunding', 'video', 'pause');
                }

                function onFinish(id) {
                    ga('send', 'event', 'crowdfunding', 'video', 'finish');
                }

                function onPlay(data, id) {
                    ga('send', 'event', 'crowdfunding', 'video', 'play');
                }

            });
        </script>
    </body>

{% endblock bodycontents %}
